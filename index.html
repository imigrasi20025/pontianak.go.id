<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kantor Imigrasi Kelas 1 TPI Pontianak - Status Paspor</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-blue: #003d7a;
            --secondary-blue: #0066cc;
            --light-blue: #e6f2ff;
            --gold: #ffd700;
            --dark-gold: #ccac00;
            --text-dark: #333;
            --danger-red: #dc3545;
            --success-green: #28a745;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f8fa;
            color: var(--text-dark);
            line-height: 1.6;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
            color: white;
            padding: 20px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .logo-container {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .logo-img {
            width: 80px;
            height: 80px;
            margin-right: 15px;
            border-radius: 50%;
            background-color: white;
            padding: 5px;
        }

        .office-name {
            font-size: 1.5rem;
            font-weight: bold;
            text-align: center;
        }

        .office-subtitle {
            font-size: 0.9rem;
            opacity: 0.9;
            text-align: center;
        }

        .container {
            max-width: 900px;
            margin: 30px auto;
            padding: 0 15px;
        }

        .card {
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            margin-bottom: 25px;
            overflow: hidden;
            border: none;
        }

        .card-header {
            background-color: var(--primary-blue);
            color: white;
            font-weight: bold;
            padding: 15px 20px;
            border-bottom: 3px solid var(--gold);
        }

        .card-body {
            padding: 20px;
        }

        .status-badge {
            display: inline-block;
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.85rem;
            margin-bottom: 15px;
        }

        .status-suspended {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }

        .info-row {
            display: flex;
            margin-bottom: 12px;
            border-bottom: 1px solid #eee;
            padding-bottom: 8px;
        }

        .info-label {
            font-weight: bold;
            width: 140px;
            color: var(--primary-blue);
        }

        .info-value {
            flex: 1;
        }

        .warning-box {
            background-color: #fff8e1;
            border-left: 4px solid var(--gold);
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 5px 5px 0;
        }

        .btn-complete {
            background: linear-gradient(135deg, var(--gold), var(--dark-gold));
            color: var(--primary-blue);
            font-weight: bold;
            padding: 12px 25px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            margin: 20px auto;
        }

        .btn-complete:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(204, 172, 0, 0.4);
        }

        .btn-complete:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }

        .loading-spinner {
            display: none;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary-blue);
            animation: spin 1s ease-in-out infinite;
            margin-right: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background-color: white;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 5px 25px rgba(0, 0, 0, 0.2);
            animation: modalSlideIn 0.3s ease-out;
        }

        @keyframes modalSlideIn {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal-header {
            background-color: var(--primary-blue);
            color: white;
            padding: 15px 20px;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-body {
            padding: 20px;
        }

        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }

        .payment-details {
            background-color: var(--light-blue);
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }

        .countdown {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--danger-red);
            text-align: center;
            margin: 15px 0;
            padding: 10px;
            background-color: #fff8f8;
            border-radius: 8px;
        }

        .countdown.expired {
            background-color: #ffebee;
            color: #c62828;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.7; }
            100% { opacity: 1; }
        }

        .note-box {
            background-color: #f8f9fa;
            border-left: 4px solid var(--danger-red);
            padding: 15px;
            margin-top: 20px;
            border-radius: 0 5px 5px 0;
        }

        .btn-pay {
            background-color: var(--primary-blue);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn-pay:hover {
            background-color: var(--secondary-blue);
        }

        .btn-pay:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        .btn-cancel {
            background-color: #6c757d;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin-right: 10px;
            transition: background-color 0.3s;
        }

        .btn-cancel:hover {
            background-color: #5a6268;
        }

        .copy-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .copy-btn {
            background-color: var(--primary-blue);
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .copy-btn:hover {
            background-color: var(--secondary-blue);
            transform: translateY(-2px);
        }

        .copy-btn.copied {
            background-color: var(--success-green);
        }

        .toast {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background-color: var(--success-green);
            color: white;
            padding: 12px 20px;
            border-radius: 5px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.2);
            opacity: 0;
            transition: all 0.3s ease;
            z-index: 2000;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toast.show {
            transform: translateX(-50%) translateY(0);
            opacity: 1;
        }

        @media (max-width: 768px) {
            .office-name {
                font-size: 1.2rem;
            }
            
            .info-row {
                flex-direction: column;
            }
            
            .info-label {
                width: 100%;
                margin-bottom: 5px;
            }

            .copy-container {
                flex-direction: column;
                align-items: flex-start;
            }

            .copy-btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo-container">
                <img src="https://z-cdn-media.chatglm.cn/files/e46214c4-0b65-42e9-bb58-85b61a4213cd.png?auth_key=1865705663-39bf5c2600cb4b22ba0bc23a678efb48-0-502c90a53695a3b1827312d9813cee0c" alt="Logo Imigrasi" class="logo-img">
                <div>
                    <h1 class="office-name">KANTOR IMIGRASI KELAS I TPI PONTIANAK</h1>
                    <p class="office-subtitle">Direktorat Jenderal Imigrasi - Kementerian Hukum dan HAM RI</p>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="card">
            <div class="card-header">
                <i class="fas fa-passport me-2"></i> Status Permohonan Paspor
            </div>
            <div class="card-body">
                <span class="status-badge status-suspended">
                    <i class="fas fa-exclamation-triangle me-1"></i> DITANGGUHKAN
                </span>
                
                <div class="info-row">
                    <div class="info-label">Nomor Paspor:</div>
                    <div class="info-value">E5861788</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Nama Pemohon:</div>
                    <div class="info-value">DWIYAN ANDRIANTO</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">NIK:</div>
                    <div class="info-value">6171050806910006</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Tempat/Tgl Lahir:</div>
                    <div class="info-value">SURABAYA, 08 - 06 - 1991</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Jenis Kelamin:</div>
                    <div class="info-value">LAKI-LAKI</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Status Permohonan:</div>
                    <div class="info-value">Permohonan Paspor Hilang</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Penangguhan:</div>
                    <div class="info-value">6 Bulan oleh Imigrasi Pontianak</div>
                </div>
                
                <div class="warning-box">
                    <h5><i class="fas fa-info-circle me-2"></i>Informasi Penting</h5>
                    <p>Berdasarkan peraturan yang berlaku, permohonan paspor Anda ditangguhkan selama 6 bulan. Namun, Anda dapat melakukan penerbitan paspor lebih cepat dengan melakukan pembayaran beban denda sesuai dengan kode pembayaran yang telah kami sediakan.</p>
                    <p><strong>Kami sangat menyarankan untuk segera melakukan pembayaran ini.</strong> Jika tidak, penangguhan akan berlanjut selama 6 bulan dan dapat diperpanjang.</p>
                </div>
                
                <button class="btn-complete" id="completeBtn">
                    <div class="loading-spinner" id="loadingSpinner"></div>
                    <span id="btnText">Selesaikan Sekarang</span>
                </button>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <i class="fas fa-building me-2"></i> Informasi Kantor Imigrasi
            </div>
            <div class="card-body">
                <div class="info-row">
                    <div class="info-label">Nama Kantor:</div>
                    <div class="info-value">Kantor Imigrasi Kelas I TPI Pontianak</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Alamat:</div>
                    <div class="info-value">Jl. Gusti Hamzah No. 1, Pontianak, Kalimantan Barat</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Telepon:</div>
                    <div class="info-value">(0561) 734762</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Email:</div>
                    <div class="info-value">pontianak@imigrasi.go.id</div>
                </div>
                
                <div class="info-row">
                    <div class="info-label">Jam Operasional:</div>
                    <div class="info-value">Senin - Jumat: 08:00 - 16:00 WIB</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Pembayaran Denda Paspor</h5>
                <button class="close-btn" id="closeModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="text-center mb-3">
                    <img src="https://z-cdn-media.chatglm.cn/files/e46214c4-0b65-42e9-bb58-85b61a4213cd.png?auth_key=1865705663-39bf5c2600cb4b22ba0bc23a678efb48-0-502c90a53695a3b1827312d9813cee0c" alt="Logo Imigrasi" style="width: 80px; height: 80px; border-radius: 50%; background-color: white; padding: 5px;">
                    <h5 class="mt-2">Kantor Imigrasi Kelas I TPI Pontianak</h5>
                </div>
                
                <div class="payment-details">
                    <div class="info-row">
                        <div class="info-label">Nomor Paspor:</div>
                        <div class="info-value">E5861788</div>
                    </div>
                    
                    <div class="info-row">
                        <div class="info-label">Nominal Pembayaran:</div>
                        <div class="info-value" style="font-weight: bold; color: var(--primary-blue);">Rp 953.500,00</div>
                    </div>
                    
                    <div class="info-row">
                        <div class="info-label">Kode Pembayaran:</div>
                        <div class="info-value">
                            <div class="copy-container">
                                <span style="font-weight: bold; font-family: monospace;" id="paymentCode">910266000001493416</span>
                                <button class="copy-btn" id="copyBtn">
                                    <i class="fas fa-copy"></i>
                                    <span id="copyBtnText">Salin</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="countdown" id="countdown">
                    <i class="fas fa-clock me-2"></i>
                    <span id="timer">02:00:00</span>
                </div>
                
                <div class="note-box">
                    <p><strong>PERHATIAN:</strong> Harap lakukan pembayaran dengan batas waktu yang telah kami tentukan dalam sistem. Jika batas waktu ini habis dan Anda tidak melakukan pembayaran, maka otomatis penerbitan paspor Anda akan ditolak atau ditangguhkan selama 10 bulan.</p>
                    <p class="mt-2">Terima kasih atas perhatian Anda.</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-cancel" id="cancelBtn">Batal</button>
                <button class="btn-pay" id="payBtn">Bayar Sekarang</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">Kode pembayaran berhasil disalin!</span>
    </div>

    <script>
        // Countdown timer functionality
        let countdownInterval;
        let targetTime;
        
        // Function to initialize or get countdown
        function initializeCountdown() {
            // Get stored deadline from localStorage
            const storedDeadline = localStorage.getItem('paymentDeadline');
            const now = new Date().getTime();
            
            if (storedDeadline) {
                targetTime = parseInt(storedDeadline);
                // If stored deadline is in the past, create a new one
                if (targetTime <= now) {
                    targetTime = now + (2 * 60 * 60 * 1000); // 2 hours in milliseconds
                    localStorage.setItem('paymentDeadline', targetTime.toString());
                }
            } else {
                // Create new deadline (2 hours from now)
                targetTime = now + (2 * 60 * 60 * 1000);
                localStorage.setItem('paymentDeadline', targetTime.toString());
            }
            
            return targetTime;
        }
        
        // Function to update countdown display
        function updateCountdown() {
            const now = new Date().getTime();
            const distance = targetTime - now;
            
            if (distance < 0) {
                clearInterval(countdownInterval);
                document.getElementById('timer').textContent = "Waktu Habis";
                document.getElementById('countdown').classList.add('expired');
                document.getElementById('payBtn').disabled = true;
                localStorage.removeItem('paymentDeadline');
                return;
            }
            
            // Calculate hours, minutes, seconds
            const hours = Math.floor(distance / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
            
            // Display with leading zeros
            document.getElementById('timer').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Add warning effect when less than 5 minutes
            if (distance < (5 * 60 * 1000)) {
                document.getElementById('countdown').style.color = '#ff0000';
                document.getElementById('countdown').style.fontWeight = 'bold';
            }
        }
        
        // Function to start countdown
        function startCountdown() {
            // Initialize the countdown
            targetTime = initializeCountdown();
            
            // Clear any existing interval
            if (countdownInterval) {
                clearInterval(countdownInterval);
            }
            
            // Update immediately
            updateCountdown();
            
            // Update every second
            countdownInterval = setInterval(updateCountdown, 1000);
        }
        
        // Function to show toast notification
        function showToast(message) {
            const toast = document.getElementById('toast');
            document.getElementById('toastMessage').textContent = message;
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
        
        // Copy to clipboard functionality
        document.getElementById('copyBtn').addEventListener('click', async function() {
            const paymentCode = document.getElementById('paymentCode').textContent;
            const copyBtn = this;
            const copyBtnText = document.getElementById('copyBtnText');
            const originalIcon = copyBtn.querySelector('i').className;
            
            try {
                // Try using the modern clipboard API
                await navigator.clipboard.writeText(paymentCode);
                
                // Update button state
                copyBtn.classList.add('copied');
                copyBtn.querySelector('i').className = 'fas fa-check';
                copyBtnText.textContent = 'Tersalin';
                
                // Show toast notification
                showToast('Kode pembayaran berhasil disalin!');
                
                // Reset button after 2 seconds
                setTimeout(() => {
                    copyBtn.classList.remove('copied');
                    copyBtn.querySelector('i').className = originalIcon;
                    copyBtnText.textContent = 'Salin';
                }, 2000);
                
            } catch (err) {
                // Fallback for older browsers
                const textArea = document.createElement('textarea');
                textArea.value = paymentCode;
                textArea.style.position = 'fixed';
                textArea.style.opacity = '0';
                document.body.appendChild(textArea);
                textArea.select();
                
                try {
                    document.execCommand('copy');
                    
                    // Update button state
                    copyBtn.classList.add('copied');
                    copyBtn.querySelector('i').className = 'fas fa-check';
                    copyBtnText.textContent = 'Tersalin';
                    
                    // Show toast notification
                    showToast('Kode pembayaran berhasil disalin!');
                    
                    // Reset button after 2 seconds
                    setTimeout(() => {
                        copyBtn.classList.remove('copied');
                        copyBtn.querySelector('i').className = originalIcon;
                        copyBtnText.textContent = 'Salin';
                    }, 2000);
                    
                } catch (fallbackErr) {
                    showToast('Gagal menyalin kode. Silakan salin manual.');
                }
                
                document.body.removeChild(textArea);
            }
        });
        
        // Complete button click handler
        document.getElementById('completeBtn').addEventListener('click', function() {
            // Show loading spinner
            document.getElementById('loadingSpinner').style.display = 'inline-block';
            document.getElementById('btnText').textContent = 'Memproses...';
            this.disabled = true;
            
            // Simulate processing delay
            setTimeout(function() {
                // Hide loading spinner
                document.getElementById('loadingSpinner').style.display = 'none';
                document.getElementById('btnText').textContent = 'Selesaikan Sekarang';
                document.getElementById('completeBtn').disabled = false;
                
                // Show payment modal
                document.getElementById('paymentModal').style.display = 'flex';
                
                // Start countdown
                startCountdown();
            }, 1500);
        });
        
        // Close modal handlers
        document.getElementById('closeModal').addEventListener('click', function() {
            document.getElementById('paymentModal').style.display = 'none';
            // Keep countdown running even when modal is closed
        });
        
        document.getElementById('cancelBtn').addEventListener('click', function() {
            document.getElementById('paymentModal').style.display = 'none';
            // Keep countdown running even when modal is closed
        });
        
        // Pay button handler
        document.getElementById('payBtn').addEventListener('click', function() {
            alert('Anda akan diarahkan ke halaman pembayaran. Mohon tunggu...');
            // In a real application, this would redirect to a payment gateway
        });
        
        // Close modal when clicking outside of it
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('paymentModal');
            if (event.target === modal) {
                modal.style.display = 'none';
                // Keep countdown running even when modal is closed
            }
        });
        
        // Check if there's an active countdown when page loads
        window.addEventListener('load', function() {
            const storedDeadline = localStorage.getItem('paymentDeadline');
            if (storedDeadline) {
                const now = new Date().getTime();
                const deadline = parseInt(storedDeadline);
                if (deadline > now) {
                    // There's still time left, but don't show modal automatically
                    // The countdown will start when user clicks the button
                } else {
                    // Clear expired deadline
                    localStorage.removeItem('paymentDeadline');
                }
            }
        });
        
        // Optional: Show countdown in console for debugging
        setInterval(function() {
            const storedDeadline = localStorage.getItem('paymentDeadline');
            if (storedDeadline) {
                const now = new Date().getTime();
                const deadline = parseInt(storedDeadline);
                const remaining = deadline - now;
                if (remaining > 0) {
                    console.log(`Countdown running: ${Math.floor(remaining/1000)} seconds remaining`);
                }
            }
        }, 10000); // Check every 10 seconds
    </script>
</body>
</html>
